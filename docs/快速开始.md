# RV1126 Demo 快速开始指南

本文档介绍如何编译和运行本项目的演示程序。

## 1. 环境准备

确保您的编译机已安装交叉编译工具链，并完成了第三方库的准备。

- **交叉编译工具链**: `arm-rockchip830-linux-gnueabihf` (路径见 `CMakeLists.txt`)
- **第三方库**: 
  - **FFmpeg**: 位于 `3rdparty/ffmpeg_install`
  - **Media SDK**: 位于 `3rdparty/media` (包含 rkaiq, mpp, rga 等)

## 2. 编译项目

在项目根目录下执行编译脚本：

```bash
./build.sh
```

编译成功后，可执行文件将生成在 `build/rv_demo`。

### 编译说明
- **应用逻辑**: 主要包含在 `src/main.c`, `src/config.c` 以及 `capture/`, `encoder/`, `streamer/` 目录下。
- **官方库代码**: 为了保持兼容性，官方提供的公共代码存放在 `src/common` 和 `include/common` 中，**请勿修改**这些文件。

## 3. 部署到开发板

### 3.1 上传文件

**使用 ADB 上传：**
```bash
adb push build/rv_demo /userdata/demo/
adb push run.sh /userdata/demo/
```

**上传依赖库 (如有必要)：**
如果板子系统中没有对应的动态库，需将 `3rdparty/ffmpeg_install/lib/` 和 `3rdparty/media/lib/` 下的 `.so` 文件上传到板子的 `/usr/lib` 或指定目录下。

## 4. 运行程序

在开发板上执行：

```bash
cd /userdata/demo
chmod +x run.sh
./run.sh
```

`run.sh` 会自动设置 `LD_LIBRARY_PATH` 环境变量。

## 5. 预期输出

```text
Hello World from C Language!
...
[ISP] Initializing ISP for Cam 0...
[ISP] Init success. Configuring Exposure...
[ISP] Settings applied: Brightness=70, Contrast=60, AE=Auto
=== Starting Video Capture Test ===
Capture started, running for approx 150 frames...
[Capture] Frame 30: 1920x1080...
...
Test finished.
```

## 6. 配置修改

如需修改硬件参数（如使用的视频设备、分辨率等），请编辑：
- **`include/config.h`**: 修改静态编译默认值。
- **`/userdata/rkipc.ini`**: (板子上) 修改 ISP 模块读取的动态参数。
