# RTSP 推流集成说明

## 当前视频流图（仅编码落盘）

```
Sensor -> ISP -> VI -> VENC -> 文件(/tmp/rv_demo.h264)
```

说明：
- 采集与编码由 Rockchip MPI 完成
- 码流直接写入文件，未做网络推流

## 目标视频流图（加入 RTSP 推流）

```
Sensor -> ISP -> VI -> VENC -> RTSP Server -> 客户端播放
                     \
                      \-> (可选) 文件落盘
```

说明：
- VENC 输出码流发送到 RTSP server
- 客户端通过 rtsp://<ip>/live/0 获取实时画面

## 多路编码视频流图（当前：双路）

```
Sensor -> ISP -> VI -> VENC(0) -> RTSP /live/0
                 \-> VENC(1) -> RTSP /live/1
```

说明：
- 当前已实现双路编码与双 RTSP 路径
- 后续可扩展到更多路

## 单路 vs 双路编码（优缺点）

单路编码优点：
- 资源占用低（CPU/内存/带宽压力小）
- 延迟更容易控制
- 逻辑简单，调试成本低

双路编码优点：
- 可同时满足“高清主码流 + 低码率子码流”需求
- 便于不同客户端按需选择
- 提升多场景兼容性（存储/预览/远程）

单路编码缺点：
- 只能固定一种画质/码率
- 不适合同时兼顾预览与存储

双路编码缺点：
- 资源占用更高，可能增加延迟
- 配置与维护复杂度上升

## 计划集成点
- 在 VENC 取流线程中调用 `rkipc_rtsp_write_video_frame()`
- 初始化阶段调用 `rkipc_rtsp_init()`，释放阶段调用 `rkipc_rtsp_deinit()`
- 使用 `common/rtsp` 模块（已保留）

## 后续配置方向
- RTSP URL 建议默认：`/live/0`
- 码流类型与编码器保持一致（H.264/H.265）
